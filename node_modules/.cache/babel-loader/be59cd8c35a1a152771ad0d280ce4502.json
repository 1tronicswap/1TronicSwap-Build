{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useEffect, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useWeb3React } from '@web3-react/core';\nimport useWeb3Provider from 'hooks/useActiveWeb3React';\nimport useDebounce from 'hooks/useDebounce';\nimport useIsWindowVisible from 'hooks/useIsWindowVisible';\nimport { updateBlockNumber } from './actions';\nexport default function Updater() {\n  _s();\n\n  const {\n    chainId\n  } = useWeb3React();\n  const {\n    library\n  } = useWeb3Provider();\n  const dispatch = useDispatch();\n  const windowVisible = useIsWindowVisible();\n  const [state, setState] = useState({\n    chainId,\n    blockNumber: null\n  });\n  const blockNumberCallback = useCallback(blockNumber => {\n    setState(prev => {\n      if (chainId === prev.chainId) {\n        if (typeof prev.blockNumber !== 'number') return {\n          chainId,\n          blockNumber\n        };\n        return {\n          chainId,\n          blockNumber: Math.max(blockNumber, prev.blockNumber)\n        };\n      }\n\n      return prev;\n    });\n  }, [chainId, setState]); // attach/detach listeners\n\n  useEffect(() => {\n    if (!library || !chainId || !windowVisible) return undefined;\n    setState({\n      chainId,\n      blockNumber: null\n    });\n    library.getBlockNumber().then(blockNumberCallback).catch(error => console.error(`Failed to get block number for chainId: ${chainId}`, error));\n    library.on('block', blockNumberCallback);\n    return () => {\n      library.removeListener('block', blockNumberCallback);\n    };\n  }, [dispatch, chainId, library, blockNumberCallback, windowVisible]);\n  const debouncedState = useDebounce(state, 100);\n  useEffect(() => {\n    if (!debouncedState.chainId || !debouncedState.blockNumber || !windowVisible) return;\n    dispatch(updateBlockNumber({\n      chainId: debouncedState.chainId,\n      blockNumber: debouncedState.blockNumber\n    }));\n  }, [windowVisible, dispatch, debouncedState.blockNumber, debouncedState.chainId]);\n  return null;\n}\n\n_s(Updater, \"dDKGsSM1wquD1heRg0cbJeVF7LU=\", false, function () {\n  return [useWeb3React, useWeb3Provider, useDispatch, useIsWindowVisible, useDebounce];\n});\n\n_c = Updater;\n\nvar _c;\n\n$RefreshReg$(_c, \"Updater\");","map":{"version":3,"sources":["D:/new/1TronicSwap-Build/src/state/application/updater.ts"],"names":["useCallback","useEffect","useState","useDispatch","useWeb3React","useWeb3Provider","useDebounce","useIsWindowVisible","updateBlockNumber","Updater","chainId","library","dispatch","windowVisible","state","setState","blockNumber","blockNumberCallback","prev","Math","max","undefined","getBlockNumber","then","catch","error","console","on","removeListener","debouncedState"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,SAAtB,EAAiCC,QAAjC,QAAiD,OAAjD;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,OAAOC,eAAP,MAA4B,0BAA5B;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAOC,kBAAP,MAA+B,0BAA/B;AACA,SAASC,iBAAT,QAAkC,WAAlC;AAEA,eAAe,SAASC,OAAT,GAAyB;AAAA;;AACtC,QAAM;AAAEC,IAAAA;AAAF,MAAcN,YAAY,EAAhC;AACA,QAAM;AAAEO,IAAAA;AAAF,MAAcN,eAAe,EAAnC;AACA,QAAMO,QAAQ,GAAGT,WAAW,EAA5B;AAEA,QAAMU,aAAa,GAAGN,kBAAkB,EAAxC;AAEA,QAAM,CAACO,KAAD,EAAQC,QAAR,IAAoBb,QAAQ,CAA8D;AAC9FQ,IAAAA,OAD8F;AAE9FM,IAAAA,WAAW,EAAE;AAFiF,GAA9D,CAAlC;AAKA,QAAMC,mBAAmB,GAAGjB,WAAW,CACpCgB,WAAD,IAAyB;AACvBD,IAAAA,QAAQ,CAAEG,IAAD,IAAU;AACjB,UAAIR,OAAO,KAAKQ,IAAI,CAACR,OAArB,EAA8B;AAC5B,YAAI,OAAOQ,IAAI,CAACF,WAAZ,KAA4B,QAAhC,EAA0C,OAAO;AAAEN,UAAAA,OAAF;AAAWM,UAAAA;AAAX,SAAP;AAC1C,eAAO;AAAEN,UAAAA,OAAF;AAAWM,UAAAA,WAAW,EAAEG,IAAI,CAACC,GAAL,CAASJ,WAAT,EAAsBE,IAAI,CAACF,WAA3B;AAAxB,SAAP;AACD;;AACD,aAAOE,IAAP;AACD,KANO,CAAR;AAOD,GAToC,EAUrC,CAACR,OAAD,EAAUK,QAAV,CAVqC,CAAvC,CAZsC,CAyBtC;;AACAd,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACU,OAAD,IAAY,CAACD,OAAb,IAAwB,CAACG,aAA7B,EAA4C,OAAOQ,SAAP;AAE5CN,IAAAA,QAAQ,CAAC;AAAEL,MAAAA,OAAF;AAAWM,MAAAA,WAAW,EAAE;AAAxB,KAAD,CAAR;AAEAL,IAAAA,OAAO,CACJW,cADH,GAEGC,IAFH,CAEQN,mBAFR,EAGGO,KAHH,CAGUC,KAAD,IAAWC,OAAO,CAACD,KAAR,CAAe,2CAA0Cf,OAAQ,EAAjE,EAAoEe,KAApE,CAHpB;AAKAd,IAAAA,OAAO,CAACgB,EAAR,CAAW,OAAX,EAAoBV,mBAApB;AACA,WAAO,MAAM;AACXN,MAAAA,OAAO,CAACiB,cAAR,CAAuB,OAAvB,EAAgCX,mBAAhC;AACD,KAFD;AAGD,GAdQ,EAcN,CAACL,QAAD,EAAWF,OAAX,EAAoBC,OAApB,EAA6BM,mBAA7B,EAAkDJ,aAAlD,CAdM,CAAT;AAgBA,QAAMgB,cAAc,GAAGvB,WAAW,CAACQ,KAAD,EAAQ,GAAR,CAAlC;AAEAb,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAAC4B,cAAc,CAACnB,OAAhB,IAA2B,CAACmB,cAAc,CAACb,WAA3C,IAA0D,CAACH,aAA/D,EAA8E;AAC9ED,IAAAA,QAAQ,CAACJ,iBAAiB,CAAC;AAAEE,MAAAA,OAAO,EAAEmB,cAAc,CAACnB,OAA1B;AAAmCM,MAAAA,WAAW,EAAEa,cAAc,CAACb;AAA/D,KAAD,CAAlB,CAAR;AACD,GAHQ,EAGN,CAACH,aAAD,EAAgBD,QAAhB,EAA0BiB,cAAc,CAACb,WAAzC,EAAsDa,cAAc,CAACnB,OAArE,CAHM,CAAT;AAKA,SAAO,IAAP;AACD;;GAlDuBD,O;UACFL,Y,EACAC,e,EACHF,W,EAEKI,kB,EAqCCD,W;;;KA1CDG,O","sourcesContent":["import { useCallback, useEffect, useState } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\nimport { useWeb3React } from '@web3-react/core'\r\nimport useWeb3Provider from 'hooks/useActiveWeb3React'\r\nimport useDebounce from 'hooks/useDebounce'\r\nimport useIsWindowVisible from 'hooks/useIsWindowVisible'\r\nimport { updateBlockNumber } from './actions'\r\n\r\nexport default function Updater(): null {\r\n  const { chainId } = useWeb3React()\r\n  const { library } = useWeb3Provider()\r\n  const dispatch = useDispatch()\r\n\r\n  const windowVisible = useIsWindowVisible()\r\n\r\n  const [state, setState] = useState<{ chainId: number | undefined; blockNumber: number | null }>({\r\n    chainId,\r\n    blockNumber: null,\r\n  })\r\n\r\n  const blockNumberCallback = useCallback(\r\n    (blockNumber: number) => {\r\n      setState((prev) => {\r\n        if (chainId === prev.chainId) {\r\n          if (typeof prev.blockNumber !== 'number') return { chainId, blockNumber }\r\n          return { chainId, blockNumber: Math.max(blockNumber, prev.blockNumber) }\r\n        }\r\n        return prev\r\n      })\r\n    },\r\n    [chainId, setState],\r\n  )\r\n\r\n  // attach/detach listeners\r\n  useEffect(() => {\r\n    if (!library || !chainId || !windowVisible) return undefined\r\n\r\n    setState({ chainId, blockNumber: null })\r\n\r\n    library\r\n      .getBlockNumber()\r\n      .then(blockNumberCallback)\r\n      .catch((error) => console.error(`Failed to get block number for chainId: ${chainId}`, error))\r\n\r\n    library.on('block', blockNumberCallback)\r\n    return () => {\r\n      library.removeListener('block', blockNumberCallback)\r\n    }\r\n  }, [dispatch, chainId, library, blockNumberCallback, windowVisible])\r\n\r\n  const debouncedState = useDebounce(state, 100)\r\n\r\n  useEffect(() => {\r\n    if (!debouncedState.chainId || !debouncedState.blockNumber || !windowVisible) return\r\n    dispatch(updateBlockNumber({ chainId: debouncedState.chainId, blockNumber: debouncedState.blockNumber }))\r\n  }, [windowVisible, dispatch, debouncedState.blockNumber, debouncedState.chainId])\r\n\r\n  return null\r\n}\r\n"]},"metadata":{},"sourceType":"module"}