{"ast":null,"code":"import { createReducer } from '@reduxjs/toolkit';\nimport { INITIAL_ALLOWED_SLIPPAGE, DEFAULT_DEADLINE_FROM_NOW } from '../../config/constants';\nimport { updateVersion } from '../global/actions';\nimport { addSerializedPair, addSerializedToken, removeSerializedPair, removeSerializedToken, updateUserExpertMode, updateUserSlippageTolerance, updateUserDeadline, updateUserSingleHopOnly, muteAudio, unmuteAudio } from './actions';\n\nconst currentTimestamp = () => new Date().getTime();\n\nfunction pairKey(token0Address, token1Address) {\n  return `${token0Address};${token1Address}`;\n}\n\nexport const initialState = {\n  userExpertMode: false,\n  userSingleHopOnly: false,\n  userSlippageTolerance: INITIAL_ALLOWED_SLIPPAGE,\n  userDeadline: DEFAULT_DEADLINE_FROM_NOW,\n  tokens: {},\n  pairs: {},\n  timestamp: currentTimestamp(),\n  audioPlay: true\n};\nexport default createReducer(initialState, builder => builder.addCase(updateVersion, state => {\n  // slippage isnt being tracked in local storage, reset to default\n  // noinspection SuspiciousTypeOfGuard\n  if (typeof state.userSlippageTolerance !== 'number') {\n    state.userSlippageTolerance = INITIAL_ALLOWED_SLIPPAGE;\n  } // deadline isnt being tracked in local storage, reset to default\n  // noinspection SuspiciousTypeOfGuard\n\n\n  if (typeof state.userDeadline !== 'number') {\n    state.userDeadline = DEFAULT_DEADLINE_FROM_NOW;\n  }\n\n  state.lastUpdateVersionTimestamp = currentTimestamp();\n}).addCase(updateUserExpertMode, (state, action) => {\n  state.userExpertMode = action.payload.userExpertMode;\n  state.timestamp = currentTimestamp();\n}).addCase(updateUserSlippageTolerance, (state, action) => {\n  state.userSlippageTolerance = action.payload.userSlippageTolerance;\n  state.timestamp = currentTimestamp();\n}).addCase(updateUserDeadline, (state, action) => {\n  state.userDeadline = action.payload.userDeadline;\n  state.timestamp = currentTimestamp();\n}).addCase(updateUserSingleHopOnly, (state, action) => {\n  state.userSingleHopOnly = action.payload.userSingleHopOnly;\n}).addCase(addSerializedToken, (state, _ref) => {\n  let {\n    payload: {\n      serializedToken\n    }\n  } = _ref;\n\n  if (!state.tokens) {\n    state.tokens = {};\n  }\n\n  state.tokens[serializedToken.chainId] = state.tokens[serializedToken.chainId] || {};\n  state.tokens[serializedToken.chainId][serializedToken.address] = serializedToken;\n  state.timestamp = currentTimestamp();\n}).addCase(removeSerializedToken, (state, _ref2) => {\n  let {\n    payload: {\n      address,\n      chainId\n    }\n  } = _ref2;\n\n  if (!state.tokens) {\n    state.tokens = {};\n  }\n\n  state.tokens[chainId] = state.tokens[chainId] || {};\n  delete state.tokens[chainId][address];\n  state.timestamp = currentTimestamp();\n}).addCase(addSerializedPair, (state, _ref3) => {\n  let {\n    payload: {\n      serializedPair\n    }\n  } = _ref3;\n\n  if (serializedPair.token0.chainId === serializedPair.token1.chainId && serializedPair.token0.address !== serializedPair.token1.address) {\n    const {\n      chainId\n    } = serializedPair.token0;\n    state.pairs[chainId] = state.pairs[chainId] || {};\n    state.pairs[chainId][pairKey(serializedPair.token0.address, serializedPair.token1.address)] = serializedPair;\n  }\n\n  state.timestamp = currentTimestamp();\n}).addCase(removeSerializedPair, (state, _ref4) => {\n  let {\n    payload: {\n      chainId,\n      tokenAAddress,\n      tokenBAddress\n    }\n  } = _ref4;\n\n  if (state.pairs[chainId]) {\n    // just delete both keys if either exists\n    delete state.pairs[chainId][pairKey(tokenAAddress, tokenBAddress)];\n    delete state.pairs[chainId][pairKey(tokenBAddress, tokenAAddress)];\n  }\n\n  state.timestamp = currentTimestamp();\n}).addCase(muteAudio, state => {\n  state.audioPlay = false;\n}).addCase(unmuteAudio, state => {\n  state.audioPlay = true;\n}));","map":{"version":3,"sources":["D:/new/1TronicSwap-Build/src/state/user/reducer.ts"],"names":["createReducer","INITIAL_ALLOWED_SLIPPAGE","DEFAULT_DEADLINE_FROM_NOW","updateVersion","addSerializedPair","addSerializedToken","removeSerializedPair","removeSerializedToken","updateUserExpertMode","updateUserSlippageTolerance","updateUserDeadline","updateUserSingleHopOnly","muteAudio","unmuteAudio","currentTimestamp","Date","getTime","pairKey","token0Address","token1Address","initialState","userExpertMode","userSingleHopOnly","userSlippageTolerance","userDeadline","tokens","pairs","timestamp","audioPlay","builder","addCase","state","lastUpdateVersionTimestamp","action","payload","serializedToken","chainId","address","serializedPair","token0","token1","tokenAAddress","tokenBAddress"],"mappings":"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","sourcesContent":["import { createReducer } from '@reduxjs/toolkit'\r\nimport { INITIAL_ALLOWED_SLIPPAGE, DEFAULT_DEADLINE_FROM_NOW } from '../../config/constants'\r\nimport { updateVersion } from '../global/actions'\r\nimport {\r\n  addSerializedPair,\r\n  addSerializedToken,\r\n  removeSerializedPair,\r\n  removeSerializedToken,\r\n  SerializedPair,\r\n  SerializedToken,\r\n  updateUserExpertMode,\r\n  updateUserSlippageTolerance,\r\n  updateUserDeadline,\r\n  updateUserSingleHopOnly,\r\n  muteAudio,\r\n  unmuteAudio,\r\n} from './actions'\r\n\r\nconst currentTimestamp = () => new Date().getTime()\r\n\r\nexport interface UserState {\r\n  // the timestamp of the last updateVersion action\r\n  lastUpdateVersionTimestamp?: number\r\n\r\n  userExpertMode: boolean\r\n\r\n  // only allow swaps on direct pairs\r\n  userSingleHopOnly: boolean\r\n\r\n  // user defined slippage tolerance in bips, used in all txns\r\n  userSlippageTolerance: number\r\n\r\n  // deadline set by user in minutes, used in all txns\r\n  userDeadline: number\r\n\r\n  tokens: {\r\n    [chainId: number]: {\r\n      [address: string]: SerializedToken\r\n    }\r\n  }\r\n\r\n  pairs: {\r\n    [chainId: number]: {\r\n      // keyed by token0Address:token1Address\r\n      [key: string]: SerializedPair\r\n    }\r\n  }\r\n\r\n  timestamp: number\r\n  audioPlay: boolean\r\n}\r\n\r\nfunction pairKey(token0Address: string, token1Address: string) {\r\n  return `${token0Address};${token1Address}`\r\n}\r\n\r\nexport const initialState: UserState = {\r\n  userExpertMode: false,\r\n  userSingleHopOnly: false,\r\n  userSlippageTolerance: INITIAL_ALLOWED_SLIPPAGE,\r\n  userDeadline: DEFAULT_DEADLINE_FROM_NOW,\r\n  tokens: {},\r\n  pairs: {},\r\n  timestamp: currentTimestamp(),\r\n  audioPlay: true,\r\n}\r\n\r\nexport default createReducer(initialState, (builder) =>\r\n  builder\r\n    .addCase(updateVersion, (state) => {\r\n      // slippage isnt being tracked in local storage, reset to default\r\n      // noinspection SuspiciousTypeOfGuard\r\n      if (typeof state.userSlippageTolerance !== 'number') {\r\n        state.userSlippageTolerance = INITIAL_ALLOWED_SLIPPAGE\r\n      }\r\n\r\n      // deadline isnt being tracked in local storage, reset to default\r\n      // noinspection SuspiciousTypeOfGuard\r\n      if (typeof state.userDeadline !== 'number') {\r\n        state.userDeadline = DEFAULT_DEADLINE_FROM_NOW\r\n      }\r\n\r\n      state.lastUpdateVersionTimestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserExpertMode, (state, action) => {\r\n      state.userExpertMode = action.payload.userExpertMode\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserSlippageTolerance, (state, action) => {\r\n      state.userSlippageTolerance = action.payload.userSlippageTolerance\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserDeadline, (state, action) => {\r\n      state.userDeadline = action.payload.userDeadline\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserSingleHopOnly, (state, action) => {\r\n      state.userSingleHopOnly = action.payload.userSingleHopOnly\r\n    })\r\n    .addCase(addSerializedToken, (state, { payload: { serializedToken } }) => {\r\n      if (!state.tokens) {\r\n        state.tokens = {}\r\n      }\r\n      state.tokens[serializedToken.chainId] = state.tokens[serializedToken.chainId] || {}\r\n      state.tokens[serializedToken.chainId][serializedToken.address] = serializedToken\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(removeSerializedToken, (state, { payload: { address, chainId } }) => {\r\n      if (!state.tokens) {\r\n        state.tokens = {}\r\n      }\r\n      state.tokens[chainId] = state.tokens[chainId] || {}\r\n      delete state.tokens[chainId][address]\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(addSerializedPair, (state, { payload: { serializedPair } }) => {\r\n      if (\r\n        serializedPair.token0.chainId === serializedPair.token1.chainId &&\r\n        serializedPair.token0.address !== serializedPair.token1.address\r\n      ) {\r\n        const { chainId } = serializedPair.token0\r\n        state.pairs[chainId] = state.pairs[chainId] || {}\r\n        state.pairs[chainId][pairKey(serializedPair.token0.address, serializedPair.token1.address)] = serializedPair\r\n      }\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(removeSerializedPair, (state, { payload: { chainId, tokenAAddress, tokenBAddress } }) => {\r\n      if (state.pairs[chainId]) {\r\n        // just delete both keys if either exists\r\n        delete state.pairs[chainId][pairKey(tokenAAddress, tokenBAddress)]\r\n        delete state.pairs[chainId][pairKey(tokenBAddress, tokenAAddress)]\r\n      }\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(muteAudio, (state) => {\r\n      state.audioPlay = false\r\n    })\r\n    .addCase(unmuteAudio, (state) => {\r\n      state.audioPlay = true\r\n    }),\r\n)\r\n"]},"metadata":{},"sourceType":"module"}